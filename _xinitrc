#!/bin/sh

# Source scripts in /etc/X11/xinit/xinitrc.d/
if [ -d /etc/X11/xinit/xinitrc.d ]; then
    for f in /etc/X11/xinit/xinitrc.d/*; do
        [ -x "$f" ] && . "$f"
    done
    unset f
fi

xhost +localhost

# somehow the setting through dconf does not persist through reboot
setxkbmap -option ctrl:nocaps

# map Ctrl press-and-release to Escape
xcape -t 200 -e 'Control_L=Escape'

# layout fix for Microsoft Sculpt Ergonomic (see ~/.xkb for details)
if lsusb | grep -q "Microsoft Corp. Wireless Receiver 1461C"; then
    xkbcomp -w0 -I$HOME/.xkb $HOME/.xkb/keymap.xkb $DISPLAY
fi

eval $(ssh-agent)

# lock screen fix for gnome 3.8 w/o gdm
# https://bbs.archlinux.org/viewtopic.php?pid=1265125#p1265125
gnome-screensaver &

redshift &

exec gnome-session
#exec gnome-session-cinnamon
